# Kabalaka

[![Version](https://img.shields.io/badge/version-0.0.3-blue.svg)](https://github.com/Kolunt/tg-alarm-bot)
[![Changelog](https://img.shields.io/badge/changelog-0.0.3-green.svg)](CHANGELOG.md)

Telegram-–±–æ—Ç –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ —Å–æ–±—ã—Ç–∏—è—Ö –∏–∑ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π (–Ø–Ω–¥–µ–∫—Å –ö–∞–ª–µ–Ω–¥–∞—Ä—å –∏ Google –ö–∞–ª–µ–Ω–¥–∞—Ä—å).

**–ë–æ—Ç –≤ Telegram:** [@KabalakaBot](https://t.me/KabalakaBot)  
**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:** https://github.com/Kolunt/tg-alarm-bot

## –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üîî –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø—Ä–µ–¥—Å—Ç–æ—è—â–∏—Ö —Å–æ–±—ã—Ç–∏—è—Ö –∏–∑ –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π
- üìÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Google Calendar
- üìÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ Yandex Calendar
- ‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –¥–æ—Å—Ç—É–ø–∞

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞

### 1. –ö–ª–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```bash
git clone https://github.com/Kolunt/tg-alarm-bot.git
cd tg-alarm-bot
```

### 2. –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

```bash
pip install -r requirements.txt
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ `.env.example` –≤ `.env` –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è:

```bash
cp .env.example .env
```

### 4. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ API

#### Telegram Bot Token
1. –°–æ–∑–¥–∞–π—Ç–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ [@BotFather](https://t.me/BotFather)
2. –ü–æ–ª—É—á–∏—Ç–µ —Ç–æ–∫–µ–Ω –∏ –¥–æ–±–∞–≤—å—Ç–µ –≤ `TELEGRAM_BOT_TOKEN`

#### Google Calendar API
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Google Cloud Console](https://console.cloud.google.com/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø—Ä–æ–µ–∫—Ç –∏–ª–∏ –≤—ã–±–µ—Ä–∏—Ç–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π
3. –í–∫–ª—é—á–∏—Ç–µ Google Calendar API
4. –°–æ–∑–¥–∞–π—Ç–µ OAuth 2.0 credentials
5. –î–æ–±–∞–≤—å—Ç–µ `GOOGLE_CLIENT_ID` –∏ `GOOGLE_CLIENT_SECRET` –≤ `.env`
6. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ redirect URI –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö OAuth

#### Yandex Calendar API
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ [Yandex OAuth](https://oauth.yandex.ru/)
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
3. –ü–æ–ª—É—á–∏—Ç–µ `YANDEX_CLIENT_ID` –∏ `YANDEX_CLIENT_SECRET`
4. –î–æ–±–∞–≤—å—Ç–µ –∏—Ö –≤ `.env`
5. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ redirect URI –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

### 5. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

```bash
python init_db.py
```

## –ó–∞–ø—É—Å–∫

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

```bash
python main.py
```

### –ó–∞–ø—É—Å–∫ –Ω–∞ PythonAnywhere

–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ PythonAnywhere –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ñ–∞–π–ª–µ `pythonanywhere_setup.md`.

**–ö—Ä–∞—Ç–∫–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è:**
1. –ó–∞–≥—Ä—É–∑–∏—Ç–µ —Ñ–∞–π–ª—ã –ø—Ä–æ–µ–∫—Ç–∞ –Ω–∞ PythonAnywhere
2. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏: `pip3.10 install --user -r requirements.txt`
3. –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–π—Ç–µ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö: `python3.10 init_db.py`
4. –°–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞: `python3.10 create_admin.py`
5. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Web app –¥–ª—è –∑–∞–ø—É—Å–∫–∞ `app.py` (—Å–º. `pythonanywhere_setup.md`)
6. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Always-on task –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞: `python3.10 run_bot.py`
7. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ Scheduled tasks –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–±—ã—Ç–∏–π
8. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ OAuth credentials —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –ø–µ—Ä–≤–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π—Ç–µ –≤—Å–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (`/admin/settings`), –≤–∫–ª—é—á–∞—è OAuth credentials –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫–∞.

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞ –≤ Telegram
2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –∫–æ–º–∞–Ω–¥—É `/start` –¥–ª—è –Ω–∞—á–∞–ª–∞ —Ä–∞–±–æ—Ç—ã
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/connect_google` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Google Calendar
4. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/connect_yandex` –¥–ª—è –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è Yandex Calendar
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/settings` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Ä–µ–º–µ–Ω–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
6. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ `/list` –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–µ–π

## –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

–ü—Ä–æ–µ–∫—Ç –≤–∫–ª—é—á–∞–µ—Ç –≤–µ–±-–∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º–æ–π. –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–æ—Å—Ç—É–ø–Ω–∞ —Ç–æ–ª—å–∫–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É.

### –°–æ–∑–¥–∞–Ω–∏–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞

–ü–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö —Å–æ–∑–¥–∞–π—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

```bash
python create_admin.py
```

### –î–æ—Å—Ç—É–ø –∫ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏

- URL: `http://your-domain.com/admin/login` (–∏–ª–∏ `/admin/login` –Ω–∞ PythonAnywhere)
- –í—Ö–æ–¥ –¥–æ—Å—Ç—É–ø–µ–Ω —Ç–æ–ª—å–∫–æ –¥–ª—è —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- –í –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –¥–æ—Å—Ç—É–ø–Ω–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞, —Å–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö –∫–∞–ª–µ–Ω–¥–∞—Ä–∏

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏

- üìä **–î–∞—à–±–æ—Ä–¥**: –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, –∫–∞–ª–µ–Ω–¥–∞—Ä–∏, —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è)
- üë• **–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏**: –ü—Ä–æ—Å–º–æ—Ç—Ä –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –∫–∞–ª–µ–Ω–¥–∞—Ä—è—Ö –∏ –ª–æ–∫–∞–ª–∏–∑–∞—Ü–∏–∏
- üì® **–†–∞—Å—Å—ã–ª–∫–∏**: –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–æ–≤—ã—Ö —Ä–∞—Å—Å—ã–ª–æ–∫ —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ —è–∑—ã–∫–∞–º –∏ –æ—Ç–ª–æ–∂–µ–Ω–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–æ–π
- ‚öôÔ∏è **–ù–∞—Å—Ç—Ä–æ–π–∫–∏**:
  - –û—Å–Ω–æ–≤–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (Telegram Bot Token, OAuth credentials)
  - –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ (–∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–±—ã—Ç–∏–π, –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ)
  - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–æ—Ç–æ–º (—Å—Ç–∞—Ç—É—Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è, –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫)

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
alarm-bot/
‚îú‚îÄ‚îÄ main.py                      # –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
‚îú‚îÄ‚îÄ app.py                       # Flask –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è PythonAnywhere
‚îú‚îÄ‚îÄ run_bot.py                   # –°–∫—Ä–∏–ø—Ç –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞ (Always-on task)
‚îú‚îÄ‚îÄ bot.py                       # –õ–æ–≥–∏–∫–∞ Telegram –±–æ—Ç–∞
‚îú‚îÄ‚îÄ admin_panel.py               # –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å (–≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å)
‚îú‚îÄ‚îÄ create_admin.py              # –°–∫—Ä–∏–ø—Ç —Å–æ–∑–¥–∞–Ω–∏—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
‚îú‚îÄ‚îÄ calendar_google.py           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Google Calendar
‚îú‚îÄ‚îÄ calendar_yandex.py           # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Yandex Calendar
‚îú‚îÄ‚îÄ database.py                  # –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ scheduler.py                 # –ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–±—ã—Ç–∏–π
‚îú‚îÄ‚îÄ config.py                    # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ init_db.py                   # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –ë–î
‚îú‚îÄ‚îÄ requirements.txt             # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ .env.example                 # –ü—Ä–∏–º–µ—Ä –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ pythonanywhere_setup.md      # –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ —Ä–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏—é –Ω–∞ PythonAnywhere
‚îî‚îÄ‚îÄ README.md                    # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü—Ä–æ–µ–∫—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —Å–µ–º–∞–Ω—Ç–∏—á–µ—Å–∫–æ–µ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (Semantic Versioning) –≤ —Ñ–æ—Ä–º–∞—Ç–µ `MAJOR.MINOR.PATCH`.

- –¢–µ–∫—É—â–∞—è –≤–µ—Ä—Å–∏—è: **0.0.3**
- –§–∞–π–ª –≤–µ—Ä—Å–∏–∏: `VERSION`
- –í–µ—Ä—Å–∏—è —Ç–∞–∫–∂–µ –¥–æ—Å—Ç—É–ø–Ω–∞ –≤ `__init__.py` –∫–∞–∫ `__version__`
- –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π: `CHANGELOG.md`

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ (—É–≤–µ–ª–∏—á–µ–Ω–∏–µ patch –Ω–∞ 1) –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ:

```bash
python bump_version.py
```

–°–∫—Ä–∏–ø—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –£–≤–µ–ª–∏—á–∏—Ç –≤–µ—Ä—Å–∏—é –Ω–∞ 0.0.1 (–Ω–∞–ø—Ä–∏–º–µ—Ä, 0.0.1 ‚Üí 0.0.2)
- –û–±–Ω–æ–≤–∏—Ç —Ñ–∞–π–ª `VERSION`
- –û–±–Ω–æ–≤–∏—Ç `__version__` –≤ `__init__.py`
- –î–æ–±–∞–≤–∏—Ç –Ω–æ–≤—É—é —Å–µ–∫—Ü–∏—é –≤ `CHANGELOG.md` —Å —Ç–µ–∫—É—â–µ–π –¥–∞—Ç–æ–π

**–í–∞–∂–Ω–æ:** –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ `bump_version.py` –Ω–µ –∑–∞–±—É–¥—å—Ç–µ –∑–∞–ø–æ–ª–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ `CHANGELOG.md` –ø–µ—Ä–µ–¥ –∫–æ–º–º–∏—Ç–æ–º!

### –ò—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–æ–µ–∫—Ç–∞ –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É—é—Ç—Å—è –≤ —Ñ–∞–π–ª–µ [CHANGELOG.md](CHANGELOG.md).

## –õ–∏—Ü–µ–Ω–∑–∏—è

MIT

